@(message: String, splunkUsers: List[String], masheryData: Map[String,Int])


@main("Sensis Project") {

    <link href='@routes.Assets.at("bootstrap/css/bootstrap.css")' rel="stylesheet">

    <!-- Loading Flat UI -->
    <link href='@routes.Assets.at("css/flat-ui.css")' rel="stylesheet">
    <link href='@routes.Assets.at("css/demo.css")' rel="stylesheet">  
    
    

  
    
    <!-- Loading JS -->
    <script src='@routes.Assets.at("js/jquery-1.8.3.min.js")'></script>
    <script src='@routes.Assets.at("js/jquery-ui-1.10.3.custom.min.js")'></script>
    <script src='@routes.Assets.at("js/jquery.ui.touch-punch.min.js")'></script>
    <script src='@routes.Assets.at("js/bootstrap.min.js")'></script>
    <script src='@routes.Assets.at("js/bootstrap-select.js")'></script>
    <script src='@routes.Assets.at("js/bootstrap-switch.js")'></script>
    <script src='@routes.Assets.at("js/flatui-checkbox.js")'></script>
    <script src='@routes.Assets.at("js/flatui-radio.js")'></script>
    <script src='@routes.Assets.at("js/jquery.tagsinput.js")'></script>
    <script src='@routes.Assets.at("js/jquery.placeholder.js")'></script>
    <script src='@routes.Assets.at("js/jquery.stacktable.js")'></script>
    <script src='@routes.Assets.at("http://vjs.zencdn.net/4.3/video.js")'></script>
    <script src='@routes.Assets.at("js/application.js")'></script>
    <script type='text/javascript' src='@routes.WebJarAssets.at(WebJarAssets.locate("jquery.min.js"))'></script>

  
   
    <!-- Dango css/js -->
    <style type="text/css">
    .radius{
            border-top-left-radius:10px;
            border-top-right-radius:10px;
            }
            
            
    .rowrow {
             width:100%;
            }
    .table-responsive {
             overflow:scroll;
             height:450px;
             width:360px;
   
            }       
    
    </style>
    
    
    <script type="text/javascript">
    
            
    </script>
    
    <link href="http://cdn.kendostatic.com/2014.1.318/styles/kendo.common.min.css" rel="stylesheet" />
    <link href="http://cdn.kendostatic.com/2014.1.318/styles/kendo.default.min.css" rel="stylesheet" />
    <link href="http://cdn.kendostatic.com/2014.1.318/styles/kendo.dataviz.min.css" rel="stylesheet" />
    <link href="http://cdn.kendostatic.com/2014.1.318/styles/kendo.dataviz.default.min.css" rel="stylesheet" />


  
    
    
    <script src="http://cdn.kendostatic.com/2014.1.318/js/kendo.all.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
    <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>

  <body>

    <!-- nav********************************** -->     
<div class="row demo-row rowrow">
        <div class="col-xs-12">
          <nav class="navbar navbar-inverse  navbar-fixed-top navbar-embossed" role="navigation">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-01">
                <span class="sr-only">Toggle navigation</span>
              </button>
            </div>
            <div class="collapse navbar-collapse" id="navbar-collapse-01">
              <ul class="nav navbar-nav navbar-left">           
                <li><a href="#fakelink">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sensis SAPI<span class="navbar-unread">1</span></a></li>
                 <li><a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></li>
                <li><a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></li>
                <li><a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></li>
                   <li><a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></li>
                <li><a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></li>
                <li><a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></li>
                <li><a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></li>
                <li><a>&nbsp;&nbsp;&nbsp;</a></li>
                <li><a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a></li>
                <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Messages <b class="caret"></b></a>
                  <span class="dropdown-arrow"></span>
                  <ul class="dropdown-menu">
                    <li><a href="#">Action</a></li>
                    <li><a href="#">Another action</a></li>
                    <li><a href="#">Something else here</a></li>
                    <li class="divider"></li>
                    <li><a href="#">Separated link</a></li>
                  </ul>
                </li>
                <li><a href="#fakelink">About Us</a></li>
              
                <li class="navbar-form navbar-right" action="#" role="search">
                    
      <div class="form-group">
   
        <div class="input-group">
          <input class="form-control" id="navbarInput-01" type="search" placeholder="Search">
          <span class="input-group-btn">
            <button type="submit" class="btn"><span class="fui-search"></span></button>
          </span>            
        </div>
       
      </div> 
    
    </li>
            </div>
               </ul>
            </div><!-- /.navbar-collapse -->
          </nav><!-- /navbar -->
        </div>
</div>
<!-- nav********************************** -->  



<!-- sidebar********************************** -->  

<div id="le" style="float:left;margin-top:32px;background-color:#34495e;width:15%;">
<ul class="nav nav-pills nav-stacked ">
  <li id="click" onclick="click()"><a href="#">&nbsp;<span class="glyphicon glyphicon-home"></span>&nbsp;&nbsp;&nbsp;Home</span></a></li>
  <li><a href="#" >&nbsp;<span class="glyphicon glyphicon-cog"></span>&nbsp;&nbsp;&nbsp;Profile</a></li>
  <li><a href="#">&nbsp;<span class="glyphicon glyphicon-comment"></span>&nbsp;&nbsp;&nbsp;Messages</a></li>
</ul>
<hr>
</div>

<!-- sidebar********************************** -->  

    
<!-- div********************************** put any thing u want-->  
<div id="ri" style="float:left;margin-left:30px;margin-top:55px;width:81%">
       
  <div id="page-wrapper">
            
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        <div class="panel-heading" style="color:#16a085">
                             Mashery Data
                            
                        </div>
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <div id="linechart" style="margin-left:13px;margin-right:13px"></div>
                          
                           
                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                    
                    <div class="panel panel-default">
                        <div class="panel-heading" style="color:#16a085">
                            Search Query/Location
                            <div class="pull-right">
                            <input type = "radio" name = "queryType" id = "byLocation" value = "location" checked = "checked" />
                 		    <label for = "byLocation">ByLocation</label>
          
          

					        <input type = "radio" name = "queryType" id = "byQuery" value = "query" />
					        <label for = "byQuery">ByQuery</label>
					        <input type="text" id="queryString" class="ddd"/> 
                      
                            <div class="btn-group">
                                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" id="endPointSearch">
                                        GO
                                    </button>
                            </div>
                            </div>
                        </div>
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                         
                             <div id="barchart" style="margin-left:13px;margin-right:13px"></div>
                        </div>
                        </div>
                        
                        
                    <div class="panel panel-default">
                        <div class="panel-heading" style="color:#16a085">
                             User Usage  
                            <div class="pull-right">
                            	   <input type="text" id="startDate" placeholder="StartAt">
                                   <input type="text" id="finishDate" placeholder="EndAt">
                                <div class="btn-group">                                   
                                   <button type="button" class="btn btn-default btn-dropdown-toggle" data-toggle="dropdown" id="pickUser">
                                        GO
                                    </button>
                                  
                                </div>
                            </div>
                        </div>
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-lg-4">
                                    <div class="table-responsive">
                                        <table class="table table-bordered table-hover table-striped">
                                                 <tbody >
                                                 @splunkUsers.map { u =>
                                                 <tr>
                                                  <td><a onclick='showSplunkOverviewData("@u")';>@u</a></td>
                                                  </tr>
                                                  }
                                                  </tbody>
                                        </table>
                                    </div>
                                    <!-- /.table-responsive -->
                                </div>
                                <!-- /.col-lg-4 (nested) -->
                                <div class="col-lg-8">
                                 <div id="chart"></div>
                                </div>
                                <!-- /.col-lg-8 (nested) -->
                           
                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                    </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                </div>
                <!-- /.col-lg-8 -->
             
                 
            </div>
            <!-- /.row -->
        </div>
        <!-- /#page-wrapper -->

    </div>
    <!-- /#wrapper -->      

    
    
    
    <!-- footer********************************** -->  
<footer>
      <div class="container">
        <div class="row">
          <div class="col-xs-7">
            <h3 class="footer-title">Subscribe</h3>
            <p>Do you like this freebie? Want to get more stuff like this?<br/>
              Subscribe to designmodo news and updates to stay tuned on great designs.<br/>
              Go to: <a href="http://designmodo.com/flat-free" target="_blank">designmodo.com/flat-free</a>
            </p>

         

          
          </div> <!-- /col-xs-7 -->

          <div class="col-xs-5">
            <div style="background-color:#1abc9c;color:white">
              <h3 class="footer-title">&nbsp;&nbsp;Get Flat UI Pro</h3>
              <ul>
                <li>Tons of Basic and Custom UI Elements</li>
                <li>A Lot of Useful Samples</li>
                <li>More Vector Icons and Glyphs</li>
              </ul>
              &nbsp;&nbsp;Go to: <a href="http://designmodo.com/flat" target="_blank">designmodo.com/flat</a>
            </div>
          </div>
        </div>
      </div>
</footer>
<!-- footer********************************** -->  
    </body>
    
    <script type="text/javascript">    
   
        
        
        
        
        
              function showUsage(search,getByListingId,serviceArea,appearance,categoriesInlocality,listingsInheadingInlocality,localitiesInState,signleSearch,userviewDetails,topCategoriesInLocality){
         $("#chart").kendoChart({
                  title: {
                      position: "top",
                      text: "Usage Distribution"
                  },
                  legend: {
                      visible: false
                  },
                  chartArea: {
                      background: ""
                  },
                  seriesDefaults: {
                      labels: {
                          visible: true,
                          background: "transparent",
                          template: "#= category #: #= value#"
                      }
                  },
                  series: [{
                      type: "pie",
                      startAngle: 180,
                      data: [{
                           category: "search"+"-"+search,
                          value: toDecimal2(search*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#e74c3c"
                      },{
                          category: "getByListingId"+"-"+getByListingId,
                          value: toDecimal2(getByListingId*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#f1c40f"
                      },{
                          category: "serviceArea"+"-"+serviceArea,
                          value: toDecimal2(serviceArea*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#3498db"
                      },{
                          category: "appearance"+"-"+appearance,
                          value: toDecimal2(appearance*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#34495e"
                      },{
                          category: "categoriesInlocality"+"-"+categoriesInlocality,
                          value: toDecimal2(categoriesInlocality*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#2ecc71"
                      },{
                          category: "listingsInheadingInlocality"+"-"+listingsInheadingInlocality,
                          value: toDecimal2(listingsInheadingInlocality*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#1abc9c"
                      },{
                          category: "localitiesInState"+"-"+localitiesInState,
                          value: toDecimal2(localitiesInState*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#9b59b6"
                      },{
                          category: "signleSearch"+"-"+signleSearch,
                          value: toDecimal2(signleSearch*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#ecf0f1"
                      },{
                          category: "userviewDetails"+"-"+userviewDetails,
                          value: toDecimal2(userviewDetails*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#95a5a6"
                      },{
                          category: "topCategoriesInLocality"+"-"+topCategoriesInLocality,
                          value: toDecimal2(topCategoriesInLocality*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#e67e22"
                      }]                      
                  }],
                  tooltip: {
                      visible: true,
                      format: "{0}%"
                  }
              });
          }
                     
	   $(document).ready(function () { 
	   userCallingInfo()
       }); 

	   function showSplunkOverviewData(key){
		   $("#startDate").val("StartAt");
		   $("#finishDate").val("EndAt");
		   document.cookie = key;
		   $.ajax({
	            type: "GET",
	            url: "/getSplunkUserOverviewData",
	            datatype: "JSON",
	            data: {k: key  }
	            }).done(function(userUsage){
	            var obj = JSON.parse(userUsage);
               
	            // showUsage(obj.search,obj.getByListingId,obj.serviceArea,obj.appearance,obj.categoriesInlocality,obj.listingsInheadingInlocality,obj.localitiesInState,obj.signleSearch,obj.userviewDetails,obj.topCategoriesInLocality);
                showUsage(obj.search,obj.getByListingId,obj.serviceArea,obj.appearance,obj.topCategoriesInLocality, obj.listingsInHeadingInLocality,obj.localitiesInState,obj.singleSearch,obj.viewDetails,obj.topCategoriesInLocality);
	            });
	   }
	   
	   
       $('#pickUser').click(function() {
       var key = document.cookie;
       var sDate = $("#startDate").val();
       var eDate = $("#finishDate").val();
           $.ajax({
            type: "GET",
            url: "/getSplunkUserByDate",
            datatype: "JSON",
            data: {s: sDate, e: eDate, k: key}
            }).done(function(userUsage){
            	var obj = JSON.parse(userUsage);
    
	            //showUsage(obj.search,obj.getByListingId,obj.serviceArea,obj.appearance,obj.categoriesInlocality,obj.listingsInheadingInlocality,obj.localitiesInState,obj.signleSearch,obj.userviewDetails,obj.topCategoriesInLocality);
                showUsage(obj.search,obj.getByListingId,obj.serviceArea,obj.appearance,obj.topCategoriesInLocality, obj.listingsInHeadingInLocality,obj.localitiesInState,obj.singleSearch,obj.viewDetails,obj.topCategoriesInLocality);
            });         
       });

       $('#endPointSearch').click(function() {          
    	   var queryType = $("input:radio[name='queryType']:checked").val();
    	   var queryString = $("#queryString").val();
               $.ajax({
                type: "GET",
                url: "/getEndPointSearch",
                datatype: "JSON",
                data: {queryStr: queryString, queryType: queryType}
                }).done(function(message){         	
                	endPointData(queryString,message)
                });         
         });
         
         function endPointData(key,value) {
         var t = value + 300;
         var keyT = key;
         var valueT = value;
            $("#barchart").kendoChart({
                title: {
                    text: ""
                },
                legend: {
                    visible: false
                },
                seriesDefaults: {
                    type: "bar"
                },
                series: [{
                    name: "Total Visits",
                    data: [valueT]
                }],
                valueAxis: {
                    max: 7000,
                    line: {
                        visible: false
                    },
                    minorGridLines: {
                        visible: true
                    }
                },
                categoryAxis: {
                    categories: [keyT],
                    majorGridLines: {
                        visible: false
                    }
                },
                tooltip: {
                    visible: true,
                    template: "#= series.name #: #= value #"
                }
            });
        }

       function userCallingInfo() {
           $("#linechart").kendoChart({
               title: {
                   text: "Information of new user registration in last 6 years"
               },
               legend: {
                   position: "bottom"
               },
               chartArea: {
                   background: ""
               },
               seriesDefaults: {
                   type: "line",
                   style: "smooth"
               },
               series: [{
                   name: "Number of new User",
                   data: [@for( (element,0) <- masheryData.zipWithIndex ) {@element._2}, @for( (element,1) <- masheryData.zipWithIndex ) {@element._2}, @for( (element,2) <- masheryData.zipWithIndex ) {@element._2}, @for( (element,3) <- masheryData.zipWithIndex ) {@element._2}, @for( (element,4) <- masheryData.zipWithIndex ) {@element._2}, @for( (element,5) <- masheryData.zipWithIndex ) {@element._2}]
               }],
               valueAxis: {
                   labels: {
                       format: "{0}"
                   },
                   line: {
                       visible: false
                   },
                   axisCrossingValue: -10
               },
               categoryAxis: {
                   categories: [@for( (element,0) <- masheryData.zipWithIndex ) {@element._1}, @for( (element,1) <- masheryData.zipWithIndex ) {@element._1}, @for( (element,2) <- masheryData.zipWithIndex ) {@element._1}, @for( (element,3) <- masheryData.zipWithIndex ) {@element._1}, @for( (element,4) <- masheryData.zipWithIndex ) {@element._1}, @for( (element,5) <- masheryData.zipWithIndex ) {@element._1}],
                   majorGridLines: {
                       visible: false
                   }
               },
               tooltip: {
                   visible: true,
                   format: "{0}",
                   template: "#= series.name #: #= value #"
               }
           });
       }
       
       
       function toDecimal2(x) {    
            var f = parseFloat(x);    
            if (isNaN(f)) {    
                return false;    
            }    
            var f = Math.round(x*100)/100;    
            var s = f.toString();    
            var rs = s.indexOf('.');    
            if (rs < 0) {    
                rs = s.length;    
                s += '.';    
            }    
            while (s.length <= rs + 2) {    
                s += '0';    
            }    
            return s;    
        }    
        
        
        $(function(){
       	$( "#startDate" ).datepicker();
       	$( "#finishDate" ).datepicker();
     
            if($("#le").height() > $("#ri").height()){
            $("#ri").css("height",$("#le").height()) 
            }else{
            $("#le").css("height",$("#ri").height()) 
            }
            });
                 
  </script>   
 }
