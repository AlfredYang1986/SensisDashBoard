@(message: String, splunkUsers: List[String], masheryData: Map[String,Int])


@main("Sensis Project") {


    
    

    
    
 

    <!-- nav********************************** -->     
<div class="row demo-row rowrow">
        <div class="col-xs-12">
          <nav class="navbar navbar-inverse  navbar-fixed-top navbar-embossed" role="navigation">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-01">
                <span class="sr-only">Toggle navigation</span>
              </button>
            </div>
            <div class="collapse navbar-collapse" id="navbar-collapse-01">
              <ul class="nav navbar-nav navbar-left" style="width: 101%;">  
              
              
              
                <li style="margin-left:19px"><a href="#fakelink">Sensis SAPI<span class="navbar-unread">1</span></a></li>
                
                
                <li  style="float:right" class="navbar-form navbar-right" action="#" role="search">
                    
      <div class="form-group">
   
        <div class="input-group" style="width:50px">
          <input class="form-control" id="navbarInput-01" type="search" placeholder="Search" onclick="caodan()" onblur="caodan2()">
          <span class="input-group-btn">
            <button type="submit" class="btn" id="ddd"><span id="sss" class="fui-search"></span></button>
          </span>            
        </div>
       
      </div> 
    
    </li>
                <li class="dropdown" style="float:right">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Messages <b class="caret"></b></a>
                  <span class="dropdown-arrow"></span>
                  <ul class="dropdown-menu">
                    <li><a href="#">Action</a></li>
                    <li><a href="#">Another action</a></li>
                    <li><a href="#">Something else here</a></li>
                    <li class="divider"></li>
                    <li><a href="#">Separated link</a></li>
                  </ul>
                </li>
                <li style="float:right"><a href="#fakelink">About Us</a></li>
              
                
            </div>
               </ul>
            </div><!-- /.navbar-collapse -->
          </nav><!-- /navbar -->
        </div>
</div>
<!-- nav********************************** -->  



<!-- sidebar********************************** -->  

<div id="le" style="float:left;margin-top:32px;background-color:#34495e;width:15%;">
<ul class="nav nav-pills nav-stacked ">
  <li><a href="/summary">&nbsp;<span class="glyphicon glyphicon-home"></span>&nbsp;&nbsp;&nbsp;Summary</span></a></li>
  <li style="background-color:#edeff1"><a href="#">&nbsp;<span class="glyphicon glyphicon-tasks"></span>&nbsp;&nbsp;&nbsp;Usage</a></li>
  <li><a href="/quality">&nbsp;<span class="glyphicon glyphicon-heart"></span>&nbsp;&nbsp;&nbsp;Quality</a></li>
  <li><a href="/report">&nbsp;<span class="glyphicon glyphicon-th-list"></span>&nbsp;&nbsp;&nbsp;Report</a></li>
  <li><a href="insights">&nbsp;<span class="glyphicon glyphicon-screenshot"></span>&nbsp;&nbsp;&nbsp;Insights</a></li>
  <li><a href="/admin">&nbsp;<span class="glyphicon glyphicon-user"></span>&nbsp;&nbsp;&nbsp;Admin</a></li>
</ul>
<hr>
</div>

<!-- sidebar********************************** -->  

    
<!-- div********************************** put any thing u want-->  
<div id="ri" style="float:left;margin-left:30px;margin-top:55px;width:81%">
       
  <div id="page-wrapper">
            
            <div class="row">
                <div class="col-lg-12">
                    <div class="panel panel-default">
                        
                        
                          <div class="panel-heading" style="color:#16a085;padding-top:0px;height:49px;padding-right:0px;line-height:2.5">
            
                             Mashery Data 
                   
                     <div class="btn-group" style="float:right;margin-left:12px;">                                   
                                   <button type="button" class="btn btn-default btn-dropdown-toggle" data-toggle="dropdown" id="pickDate" style="
    padding-top: 13px;
    padding-bottom: 14px;
">
                                        GO
                                    </button>
                                  
                                </div>
                            
                                   <input type="text" id="finishDate1" placeholder="EndAt" class="form-control input-sm col-lg-1" style="float:right;width: 15%;margin-top:7px";>
                                   <input type="text" id="startDate1" placeholder="StartAt" class="form-control input-sm col-lg-1" style="float:right;width: 15%;margin-top:7px;margin-right:6px";>
                                 
                             
                              
                            </div>
                            
                     
                        
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <div id="linechart" style="margin-left:13px;margin-right:13px"></div>
                          
                           
                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                    
                  <div class="panel panel-default">
                  <div class="panel-heading" style="color:#16a085;padding-top:0px;height:49px;padding-right:0px;line-height:2.5">
                           Search Query/Location
                          
                          
                          
                          <div class="btn-group" style="float:right;">
                                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" id="endPointSearch" style="padding-top: 14px;padding-bottom: 14px; padding-top-right-radius:3px;margin-left:10px">
                                        GO
                                    </button>
                            </div>
                         <input type="text" id="finishDate2" placeholder="EndAt" class="form-control input-sm col-lg-1" style="float:right;width: 15%;margin-top:7px";>
                         <input type="text" id="startDate2" placeholder="StartAt" class="form-control input-sm col-lg-1" style="float:right;width: 15%;margin-top:7px;margin-right:6px";>                       
                            
    				        <!--input type="text" id="queryString" class="ddd"> -->
                          
                            

                           </div>
                     
                       
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                        <div id="barchart"></div>
                        <div style="overflow:scroll;width:100%" id="ttt">
                         <table class="table table-bordered table-hover table-striped" id="endPointTable">
                          <tbody>
					      <tr>
					      <th>Query</th>
					      <th>Location</th>
					      <th>Occurances</th>
                          </tr>
                         
                          </tbody> 
                        </table>
                        </div>
                        </div>
                        
                 </div>
                       
                     
                        
                        
                    <div class="panel panel-default">
    
                        <div class="panel-heading" style="color:#16a085;padding-top:0px;height:49px;padding-right:0px;line-height:2.5">
            
                             User Usage 
                   
                     <div class="btn-group" style="float:right;margin-left:12px">                                   
                                   <button type="button" class="btn btn-default btn-dropdown-toggle" data-toggle="dropdown" id="pickUser" style="
    padding-top: 13px;
    padding-bottom: 14px;
">
                                        GO
                                    </button>
                                  
                                </div>
                    
                          
                                   
                                   <input type="text" id="finishDate" placeholder="EndAt" class="form-control input-sm col-lg-1" style="float:right;width: 15%;margin-top:7px";>
                             
                              <input type="text" id="startDate" placeholder="StartAt" class="form-control input-sm col-lg-1" style="float:right;width: 15%;margin-top:7px;margin-right:6px";>
                            </div>
                            
                        
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-lg-4">
                                    <div class="table-responsive">
                                        <table class="table table-bordered table-hover table-striped">
                                                 <tbody >
                                                 @splunkUsers.map { u =>
                                                 <tr>
                                                  <td><a onclick='showSplunkOverviewData("@u")';>@u</a></td>
                                                  </tr>
                                                  }
                                                  </tbody>
                                        </table>
                                    </div>
                                    <!-- /.table-responsive -->
                                </div>
                                <!-- /.col-lg-4 (nested) -->
                                <div class="col-lg-8">
                                 <div id="chart"></div>
                                </div>
                                <!-- /.col-lg-8 (nested) -->
                           
                        </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                    </div>
                        <!-- /.panel-body -->
                    </div>
                    <!-- /.panel -->
                </div>
                <!-- /.col-lg-8 -->
             
                 
            </div>
            <!-- /.row -->
        </div>
        <!-- /#page-wrapper -->

    </div>
    <!-- /#wrapper -->      

    
    
    
    <!-- footer********************************** -->  
<footer>
      <div class="container">
        <div class="row">
          <div class="col-xs-7">
            <h3 class="footer-title">Subscribe</h3>
            <p>Do you like this freebie? Want to get more stuff like this?<br/>
              Subscribe to designmodo news and updates to stay tuned on great designs.<br/>
              Go to: <a href="http://designmodo.com/flat-free" target="_blank">designmodo.com/flat-free</a>
            </p>

         

          
          </div> <!-- /col-xs-7 -->

          <div class="col-xs-5">
            <div style="background-color:#1abc9c;color:white">
              <h3 class="footer-title">&nbsp;&nbsp;Get Flat UI Pro</h3>
              <ul>
                <li>Tons of Basic and Custom UI Elements</li>
                <li>A Lot of Useful Samples</li>
                <li>More Vector Icons and Glyphs</li>
              </ul>
              &nbsp;&nbsp;Go to: <a href="http://designmodo.com/flat" target="_blank">designmodo.com/flat</a>
            </div>
          </div>
        </div>
      </div>
</footer>
<!-- footer********************************** -->  

    
	   <script type="text/javascript">    
	      var cao = document.getElementById("sss");
	      var dan = document.getElementById("ddd");
	       function caodan(){
	        
	           cao.style.color = "#1abc9c";
	           dan.style.borderColor="#1abc9c";
	       }
	       
	       function caodan2(){
	         cao.style.color = "#536a81";
	          dan.style.borderColor="#293a4a";
	       }
	       
	       
	        function showUsage(search,getByListingId,serviceArea,appearance,categoriesInlocality,listingsInheadingInlocality,localitiesInState,signleSearch,userviewDetails,topCategoriesInLocality){
	        $("#chart").kendoChart({
	                 title: {
	                     position: "top",
	                     text: "Usage Distribution"
	                 },
	                 legend: {
	                     visible: false
	                 },
                  chartArea: {
                      background: ""
                  },
                  seriesDefaults: {
                      labels: {
                          visible: true,
                          background: "transparent",
                          template: "#= category #: #= value#"
                      }
                  },
               
                  series: [{
                      type: "pie",
                      startAngle: 180,
                      data: [{
                          category: "search"+"-"+search,
                          value: toDecimal2(search*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#e74c3c"
                      },{
                          category: "getByListingId"+"-"+getByListingId,
                          value: toDecimal2(getByListingId*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#f1c40f"
                      },{
                          category: "serviceArea"+"-"+serviceArea,
                          value: toDecimal2(serviceArea*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#3498db"
                      },{
                          category: "appearance"+"-"+appearance,
                          value: toDecimal2(appearance*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#34495e"
                      },{
                          category: "categoriesInlocality"+"-"+categoriesInlocality,
                          value: toDecimal2(categoriesInlocality*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#2ecc71"
                      },{
                          category: "listingsInheadingInlocality"+"-"+listingsInheadingInlocality,
                          value: toDecimal2(listingsInheadingInlocality*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#1abc9c"
                      },{
                          category: "localitiesInState"+"-"+localitiesInState,
                          value: toDecimal2(localitiesInState*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#9b59b6"
                      },{
                          category: "signleSearch"+"-"+signleSearch,
                          value: toDecimal2(signleSearch*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#ecf0f1"
                      },{
                          category: "viewDetails"+"-"+userviewDetails,
                          value: toDecimal2(userviewDetails*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#95a5a6"
                      },{
                          category: "topCategoriesInLocality"+"-"+topCategoriesInLocality,
                          value: toDecimal2(topCategoriesInLocality*100.0/(search+getByListingId+serviceArea+appearance+categoriesInlocality+listingsInheadingInlocality+localitiesInState+signleSearch+userviewDetails+topCategoriesInLocality)),
                          color: "#e67e22"
                      }]                     
                  }],
                  tooltip: {
                      visible: true,
                      format: "{0}%"
                  }
              });
          }
                     
	   $(document).ready(function () { 
	   masheryRegLineChart("Empty");
       }); 
       

	   function showSplunkOverviewData(key){
		   $("#startDate").val("StartAt");
		   $("#finishDate").val("EndAt");
		   document.cookie = key;
		   $.ajax({
	            type: "GET",
	            url: "/getSplunkUserOverviewData",
	            datatype: "JSON",
	            data: {k: key  }
	            }).done(function(userUsage){
	            var obj = JSON.parse(userUsage);               
	            // showUsage(obj.search,obj.getByListingId,obj.serviceArea,obj.appearance,obj.categoriesInlocality,obj.listingsInheadingInlocality,obj.localitiesInState,obj.signleSearch,obj.userviewDetails,obj.topCategoriesInLocality);
                showUsage(obj.search,obj.getByListingId,obj.serviceArea,obj.appearance,obj.topCategoriesInLocality, obj.listingsInHeadingInLocality,obj.localitiesInState,obj.singleSearch,obj.viewDetails,obj.topCategoriesInLocality);
	            });
	   }
	   
	   
       $('#pickUser').click(function() {
       var key = document.cookie;
       var sDate = $("#startDate").val();
       var eDate = $("#finishDate").val();
           $.ajax({
            type: "GET",
            url: "/getSplunkUserByDate",
            datatype: "JSON",
            data: {s: sDate, e: eDate, k: key}
            }).done(function(userUsage){
            	var obj = JSON.parse(userUsage);
	            //showUsage(obj.search,obj.getByListingId,obj.serviceArea,obj.appearance,obj.categoriesInlocality,obj.listingsInheadingInlocality,obj.localitiesInState,obj.signleSearch,obj.userviewDetails,obj.topCategoriesInLocality);
                showUsage(obj.search,obj.getByListingId,obj.serviceArea,obj.appearance,obj.topCategoriesInLocality, obj.listingsInHeadingInLocality,obj.localitiesInState,obj.singleSearch,obj.viewDetails,obj.topCategoriesInLocality);
            });         
       });
       
       $('#pickDate').click(function(){
        var sDate = $("#startDate1").val();
        var eDate = $("#finishDate1").val();
       $.ajax({
	            type: "GET",
	            url: "/datePickForMashery",
	            datatype: "JSON",
	            data: {s:sDate,e:eDate}
	            }).done(function(data){
	            masheryRegLineChart(data);
	            });
       });

       $('#endPointSearch').click(function() {  
           $(".insertTr").remove();
    	   var sDate = $("#startDate2").val();
           var eDate = $("#finishDate2").val();
               $.ajax({
                type: "GET",
                url: "/getEndPointSearch",
                datatype: "JSON",
                data: {s: sDate, e: eDate}
                }).done(function(data){
                $("#ttt").css("height","400px");
                var json = JSON.parse(data);
                for(var i=0;i<json.items.length;i++){
                $('#endPointTable').append('<tr class="insertTr"><td>' + json.items[i].query + '</td><td>' + json.items[i].location + '</td><td>' + json.items[i].occurances + '</td></tr>');  
                }  	
	            if($("#le").height() > $("#ri").height()){
	            $("#ri").css("height",$("#le").height()) 
	            }else{
	            $("#le").css("height",$("#ri").height()) 
	            }
	            	 $.ajax({
		                type: "GET",
		                url: "/getTopTen",
		                datatype: "JSON",
		                data: {s: sDate, e: eDate}
		                }).done(function(data){
                       
		                var json = JSON.parse(data);
		                endPointData(json.items);	
			            if($("#le").height() > $("#ri").height()){
			            $("#ri").css("height",$("#le").height()) 
			            }else{
			            $("#le").css("height",$("#ri").height()) 
			            }
                });         
                });         
          });
         
         function endPointData(data) {
            var queryString = [];
            var queryData = [];
            for(var i=0;i<data.length;i++){
            queryString.push(data[i].query + "/" + data[i].location); 
            queryData.push(data[i].occurances);
            }
            $("#barchart").kendoChart({
                title: {
                    text: ""
                },
                legend: {
                    visible: false
                },
                seriesDefaults: {
                    type: "bar"
                },
                series: [{
                    name: "Total Visits",
                    data: queryData
                }],
                valueAxis: {
                    max: 400,
                    line: {
                        visible: false
                    },
                    minorGridLines: {
                        visible: true
                    }
                },
                categoryAxis: {
                    categories: queryString,
                    majorGridLines: {
                        visible: false
                    }
                },
                tooltip: {
                    visible: true,
                    template: "#= series.name #: #= value #"
                }
            });
        }
		
	   
       function masheryRegLineChart(date) {          
           if(date == "Empty"){
       	   var dataString = [
       	   @for( (key,value) <- masheryData) {
       	   	"@key",
       	   }
       	   ];
       	   var f = [
       	   @for( (key,value) <- masheryData) {
       	   	@value,
       	   }
       	   ];
       	   }
       	   else{
       	   var dataString = date.split(":")[0].split(","); 
       	   var f = date.split(":")[1].split(",");     	   
       	   }
                 	   
           $("#linechart").kendoChart({
               title: {
                   text: "Information of new user registration"
               },
               legend: {
                   position: "bottom"
               },
               chartArea: {
                   background: ""
               },
               seriesDefaults: {
                   type: "line",
                   style: "smooth"
               },
               series: [{
                   name: "Number of new User",
                   data: f
               }],
               valueAxis: {
                   labels: {
                       format: "{0}"
                   },
                   line: {
                       visible: false
                   },
                   axisCrossingValue: -10
               },
               categoryAxis: {
                   categories: dataString,
                   majorGridLines: {
                       visible: false
                   }
               },
               tooltip: {
                   visible: true,
                   format: "{0}",
                   template: "#= series.name #: #= value #"
               }
           });
       }
       
       
       function toDecimal2(x) {    
            var f = parseFloat(x);    
            if (isNaN(f)) {    
                return false;    
            }    
            var f = Math.round(x*100)/100;    
            var s = f.toString();    
            var rs = s.indexOf('.');    
            if (rs < 0) {    
                rs = s.length;    
                s += '.';    
            }    
            while (s.length <= rs + 2) {    
                s += '0';    
            }    
            return s;    
        }    
        
        
        $(function(){
       	$( "#startDate" ).datepicker({dateFormat: 'yy-mm-dd'});
       	$( "#finishDate" ).datepicker({dateFormat: 'yy-mm-dd'});
       	$( "#startDate1" ).datepicker({dateFormat: 'yy-mm-dd'});
       	$( "#finishDate1" ).datepicker({dateFormat: 'yy-mm-dd'});
       	$( "#startDate2" ).datepicker({dateFormat: 'yy-mm-dd'});
       	$( "#finishDate2" ).datepicker({dateFormat: 'yy-mm-dd'});
     
            if($("#le").height() > $("#ri").height()){
            $("#ri").css("height",$("#le").height()) 
            }else{
            $("#le").css("height",$("#ri").height()) 
            }
            });
                 
  </script>   
 }
 